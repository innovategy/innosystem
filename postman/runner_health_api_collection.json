{
	"info": {
		"_postman_id": "b5d7e3f5-6d15-42e9-b3b5-a98cfd3e2d63",
		"name": "InnoSystem - Runner Health Monitoring",
		"description": "Collection of API endpoints for monitoring runner health, checking compatibility, and managing job assignments.",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Check Runner Health",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{admin_token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/runners/:id/health",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"runners",
						":id",
						"health"
					],
					"variable": [
						{
							"key": "id",
							"value": "00000000-0000-0000-0000-000000000000",
							"description": "UUID of the runner to check"
						}
					]
				},
				"description": "Checks the health status of a specific runner based on its last heartbeat.\n\nResponse will indicate one of the following statuses:\n- Healthy: Runner is responding and ready for work\n- Warning: Runner may be experiencing issues\n- Critical: Runner is likely down or unresponsive\n- Unknown: Runner could not be found or status could not be determined\n\nAuthorization required: Admin"
			},
			"response": [
				{
					"name": "Healthy Runner",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/runners/:id/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"runners",
								":id",
								"health"
							],
							"variable": [
								{
									"key": "id",
									"value": "00000000-0000-0000-0000-000000000000"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"status\": \"healthy\",\n    \"last_heartbeat\": \"2025-04-09T10:30:45Z\",\n    \"message\": \"Runner is healthy and responding normally\"\n}"
				},
				{
					"name": "Critical Runner",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/runners/:id/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"runners",
								":id",
								"health"
							],
							"variable": [
								{
									"key": "id",
									"value": "00000000-0000-0000-0000-000000000000"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"status\": \"critical\",\n    \"last_heartbeat\": \"2025-04-08T15:20:10Z\",\n    \"message\": \"Runner is in critical state, not responding for more than 30 minutes\"\n}"
				},
				{
					"name": "Runner Not Found",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/runners/:id/health",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"runners",
								":id",
								"health"
							],
							"variable": [
								{
									"key": "id",
									"value": "00000000-0000-0000-0000-000000000000"
								}
							]
						}
					},
					"status": "Not Found",
					"code": 404,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"error\": \"Runner not found\"\n}"
				}
			]
		},
		{
			"name": "Check Runner-Job Type Compatibility",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{admin_token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/runners/:runner_id/compatible/:job_type_id",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"runners",
						":runner_id",
						"compatible",
						":job_type_id"
					],
					"variable": [
						{
							"key": "runner_id",
							"value": "00000000-0000-0000-0000-000000000000",
							"description": "UUID of the runner to check"
						},
						{
							"key": "job_type_id",
							"value": "00000000-0000-0000-0000-000000000000",
							"description": "UUID of the job type to check compatibility with"
						}
					]
				},
				"description": "Checks if a specific runner is compatible with a given job type.\n\nResponse indicates whether the runner can process jobs of the specified type, based on the runner's configured capabilities and the job type requirements.\n\nAuthorization required: Admin"
			},
			"response": [
				{
					"name": "Compatible",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/runners/:runner_id/compatible/:job_type_id",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"runners",
								":runner_id",
								"compatible",
								":job_type_id"
							],
							"variable": [
								{
									"key": "runner_id",
									"value": "00000000-0000-0000-0000-000000000000"
								},
								{
									"key": "job_type_id",
									"value": "00000000-0000-0000-0000-000000000000"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"compatible\": true,\n    \"job_type_name\": \"Image Processing\",\n    \"runner_name\": \"GPU Worker Node 1\"\n}"
				},
				{
					"name": "Not Compatible",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/runners/:runner_id/compatible/:job_type_id",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"runners",
								":runner_id",
								"compatible",
								":job_type_id"
							],
							"variable": [
								{
									"key": "runner_id",
									"value": "00000000-0000-0000-0000-000000000000"
								},
								{
									"key": "job_type_id",
									"value": "00000000-0000-0000-0000-000000000000"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"compatible\": false,\n    \"job_type_name\": \"ML Model Training\",\n    \"runner_name\": \"Basic CPU Worker\"\n}"
				},
				{
					"name": "Runner Not Found",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/runners/:runner_id/compatible/:job_type_id",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"runners",
								":runner_id",
								"compatible",
								":job_type_id"
							],
							"variable": [
								{
									"key": "runner_id",
									"value": "11111111-1111-1111-1111-111111111111"
								},
								{
									"key": "job_type_id",
									"value": "00000000-0000-0000-0000-000000000000"
								}
							]
						}
					},
					"status": "Not Found",
					"code": 404,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"error\": \"Runner not found\"\n}"
				}
			]
		},
		{
			"name": "Find Compatible Runners",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{admin_token}}",
							"type": "string"
						}
					]
				},
				"method": "GET",
				"header": [],
				"url": {
					"raw": "{{base_url}}/job-types/:job_type_id/compatible-runners",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"job-types",
						":job_type_id",
						"compatible-runners"
					],
					"variable": [
						{
							"key": "job_type_id",
							"value": "00000000-0000-0000-0000-000000000000",
							"description": "UUID of the job type to find compatible runners for"
						}
					]
				},
				"description": "Finds all runners that are compatible with a specified job type, along with their current health status.\n\nThis is useful for determining which runners can process jobs of a particular type and identifying their availability.\n\nAuthorization required: Admin"
			},
			"response": [
				{
					"name": "Compatible Runners Found",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/job-types/:job_type_id/compatible-runners",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"job-types",
								":job_type_id",
								"compatible-runners"
							],
							"variable": [
								{
									"key": "job_type_id",
									"value": "00000000-0000-0000-0000-000000000000"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"job_type_name\": \"Video Transcoding\",\n    \"compatible_runners\": [\n        {\n            \"id\": \"00000000-0000-0000-0000-000000000001\",\n            \"name\": \"GPU Worker 1\",\n            \"health_status\": \"healthy\",\n            \"last_heartbeat\": \"2025-04-09T16:35:12Z\"\n        },\n        {\n            \"id\": \"00000000-0000-0000-0000-000000000002\",\n            \"name\": \"GPU Worker 2\",\n            \"health_status\": \"warning\",\n            \"last_heartbeat\": \"2025-04-09T16:20:45Z\"\n        },\n        {\n            \"id\": \"00000000-0000-0000-0000-000000000003\",\n            \"name\": \"GPU Worker 3\",\n            \"health_status\": \"critical\",\n            \"last_heartbeat\": \"2025-04-09T12:10:22Z\"\n        }\n    ],\n    \"total_compatible\": 3,\n    \"healthy_count\": 1\n}"
				},
				{
					"name": "No Compatible Runners",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/job-types/:job_type_id/compatible-runners",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"job-types",
								":job_type_id",
								"compatible-runners"
							],
							"variable": [
								{
									"key": "job_type_id",
									"value": "00000000-0000-0000-0000-000000000000"
								}
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"job_type_name\": \"Quantum Circuit Simulation\",\n    \"compatible_runners\": [],\n    \"total_compatible\": 0,\n    \"healthy_count\": 0\n}"
				},
				{
					"name": "Job Type Not Found",
					"originalRequest": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/job-types/:job_type_id/compatible-runners",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"job-types",
								":job_type_id",
								"compatible-runners"
							],
							"variable": [
								{
									"key": "job_type_id",
									"value": "11111111-1111-1111-1111-111111111111"
								}
							]
						}
					},
					"status": "Not Found",
					"code": 404,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"error\": \"Job type not found\"\n}"
				}
			]
		},
		{
			"name": "Check and Reassign Jobs",
			"request": {
				"auth": {
					"type": "bearer",
					"bearer": [
						{
							"key": "token",
							"value": "{{admin_token}}",
							"type": "string"
						}
					]
				},
				"method": "POST",
				"header": [],
				"body": {
					"mode": "raw",
					"raw": "",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "{{base_url}}/runners/maintenance/reassign-jobs",
					"host": [
						"{{base_url}}"
					],
					"path": [
						"runners",
						"maintenance",
						"reassign-jobs"
					]
				},
				"description": "Automatic maintenance task that checks for jobs assigned to unhealthy runners and reassigns them to healthy compatible runners.\n\nThis endpoint is designed to be used in a maintenance cron job or manually triggered by administrators to ensure jobs don't remain stuck on unhealthy runners.\n\nThe operation identifies stalled jobs (running for too long) and resets them to pending status so they can be picked up by healthy runners.\n\nAuthorization required: Admin"
			},
			"response": [
				{
					"name": "Jobs Reassigned",
					"originalRequest": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/runners/maintenance/reassign-jobs",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"runners",
								"maintenance",
								"reassign-jobs"
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"reassigned_count\": 3,\n    \"message\": \"Successfully reset 3 stalled jobs to pending status for reassignment\"\n}"
				},
				{
					"name": "No Jobs Reassigned",
					"originalRequest": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/runners/maintenance/reassign-jobs",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"runners",
								"maintenance",
								"reassign-jobs"
							]
						}
					},
					"status": "OK",
					"code": 200,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"reassigned_count\": 0,\n    \"message\": \"No stalled jobs found that need reassignment\"\n}"
				},
				{
					"name": "Error During Reassignment",
					"originalRequest": {
						"method": "POST",
						"header": [],
						"url": {
							"raw": "{{base_url}}/runners/maintenance/reassign-jobs",
							"host": [
								"{{base_url}}"
							],
							"path": [
								"runners",
								"maintenance",
								"reassign-jobs"
							]
						}
					},
					"status": "Internal Server Error",
					"code": 500,
					"_postman_previewlanguage": "json",
					"header": [
						{
							"key": "Content-Type",
							"value": "application/json"
						}
					],
					"cookie": [],
					"body": "{\n    \"error\": \"Failed to check and reassign jobs: database connection error\"\n}"
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					""
				]
			}
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8080",
			"type": "string",
			"description": "Base URL for the InnoSystem API"
		},
		{
			"key": "admin_token",
			"value": "your-admin-token-here",
			"type": "string",
			"description": "Admin authentication token"
		}
	]
}
